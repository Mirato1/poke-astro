<theme-selector></theme-selector>
<script is:inline>
  if (!customElements.get('theme-selector')) {
    customElements.define(
      'theme-selector',
      class extends HTMLElement {
        connectedCallback() {
          this.innerHTML = `
            <div class="relative inline-block">
              <select
                aria-label="Theme select"
                class="appearance-none bg-white text-slate-900 border border-gray-200 dark:bg-gray-900 dark:text-gray-200 dark:border-gray-700 rounded-md py-2 pl-3 pr-9 shadow-sm hover:border-gray-300 dark:hover:border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"
              >
                <option value="auto">Auto</option>
                <option value="light">Light</option>
                <option value="dark">Dark</option>
              </select>
              <svg
                class="pointer-events-none absolute right-2 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 dark:text-gray-500"
                viewBox="0 0 20 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true"
              >
                <path d="M6 8l4 4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          `
          this.querySelector('select').onchange = (event) => theme.setTheme(event.target.value)
          this.setAttribute('aria-label', 'Select Theme')
          this.updateSelectedTheme()

          document.addEventListener('theme-changed', (event) => {
            this.updateSelectedTheme(event.detail.theme)
          })
        }

        updateSelectedTheme(newTheme = theme.getTheme()) {
          this.querySelector('select').value = newTheme
        }
      },
    )
  }
</script>
